#include <tunables/global>

profile OctoPrint-Base flags=(attach_disconnected,mediate_deleted) {

  /usr/sbin/nginx {
    #include <abstractions/base>

    capability dac_override,
    capability dac_read_search,
    capability net_bind_service,
    capability setgid,
    capability setuid,

    # binary, pid
    /usr/sbin/nginx mr,
    /run/nginx.pid rw,

    # configuration
    /etc/nginx/mime.types r,
    /etc/nginx/nginx.conf r,
    /etc/nginx/http.d/* r,

    # logs
    /var/log/nginx/* w,

  }
}
