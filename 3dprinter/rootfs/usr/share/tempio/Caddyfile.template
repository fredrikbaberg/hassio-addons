:8099 {
	@ingress {
		remote_ip 172.30.32.2
	}
	handle {
		{{ if eq .ingress_ui "octoprint" }}
		{{ if .recovery }}
		rewrite / /recovery
		{{ end }}
		reverse_proxy @ingress localhost:80 {
			header_up X-Script-Name {{ env "ingress_entry" }}
			header_up -Origin
			header_up Origin 172.30.32.2
			header_up X-Forwarded-For 172.30.32.2
		}
		{{else if eq .ingress_ui "fluidd" }}
		root * /data/fluidd
		file_server
		{{ else }}
		# Ingress not set
		{{ end }}
	}
}

{{ if .octoprint }}
# OctoPrint WebUI
:5000 {
	reverse_proxy http://127.0.0.1:80 {
		header_up X-Scheme {scheme}
	}
}
{{ end }}

{{ if .mjpg_streamer }}
# Camera
:8000 {
	reverse_proxy http://127.0.0.1:8080 {
		header_up X-Scheme {scheme}
	}
}
{{ end }}

{{ if .fluidd }}
# Fluidd
:6000 {
	root * /fluidd
	file_server
}
{{ end }}
